% Welcome to the source code of extouchtriangle.sty. We hope you
% enjoy your visit.
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
%
% This is a clone of evan.sty. The license of evan.sty is reproduced below:
% https://github.com/vEnhance/dotfiles/blob/main/texmf/tex/latex/evan/evan.sty %
%                                                                              %
%                                                       |  \                   %
%      ______  __     __  ______  _______      _______ _| ▓▓_   __    __       %
%     /      \|  \   /  \|      \|       \    /       \   ▓▓ \ |  \  |  \      %
%    |  ▓▓▓▓▓▓\\▓▓\ /  ▓▓ \▓▓▓▓▓▓\ ▓▓▓▓▓▓▓\  |  ▓▓▓▓▓▓▓\▓▓▓▓▓▓ | ▓▓  | ▓▓      %
%    | ▓▓    ▓▓ \▓▓\  ▓▓ /      ▓▓ ▓▓  | ▓▓   \▓▓    \  | ▓▓ __| ▓▓  | ▓▓      %
%    | ▓▓▓▓▓▓▓▓  \▓▓ ▓▓ |  ▓▓▓▓▓▓▓ ▓▓  | ▓▓__ _\▓▓▓▓▓▓\ | ▓▓|  \ ▓▓__/ ▓▓      %
%     \▓▓     \   \▓▓▓   \▓▓    ▓▓ ▓▓  | ▓▓  \       ▓▓  \▓▓  ▓▓\▓▓    ▓▓      %
%      \▓▓▓▓▓▓▓    \▓     \▓▓▓▓▓▓▓\▓▓   \▓▓\▓▓\▓▓▓▓▓▓▓    \▓▓▓▓ _\▓▓▓▓▓▓▓      %
%                                                              |  \__| ▓▓      %
%                                                               \▓▓    ▓▓      %
%                                                                \▓▓▓▓▓▓       %
%                                                                              %
% https://github.com/vEnhance/dotfiles/blob/main/texmf/tex/latex/evan/evan.sty %

% ░█▄█░▄▀▄░█░░▒█░░░▀█▀░▄▀▄░░░█▒█░▄▀▀▒██▀
% ▒█▒█░▀▄▀░▀▄▀▄▀▒░░▒█▒░▀▄▀▒░░▀▄█▒▄██░█▄▄
%
% If you don't know how to use this file, read:
% +--------------------------------------------+
% | https://web.evanchen.cc/faq-latex.html#L-4 |
% +--------------------------------------------+
%
% TL;DR of the Boost license conditions are as follows:
%
% 1. Any SOURCE VERSIONS must cite evan.sty and the Boost license below.
% 2. For COMPILED PDF OUTPUT, attribution of evan.sty is OPTIONAL (but nice).
% 3. NO OTHER REQUIREMENTS; you may modify, redistribute, sell freely.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% BOOST SOFTWARE LICENSE - VERSION 1.0 - 17 AUGUST 2003
%
% Copyright (c) 2023 Evan Chen [evan at evanchen.cc]
% https://web.evanchen.cc/ || github.com/vEnhance
%
% Available for download at:
% https://github.com/vEnhance/dotfiles/blob/main/texmf/tex/latex/evan/evan.sty
%
% Permission is hereby granted, free of charge, to any person or organization
% obtaining a copy of the software and accompanying documentation covered by
% this license (the "Software") to use, reproduce, display, distribute,
% execute, and transmit the Software, and to prepare derivative works of the
% Software, and to permit third-parties to whom the Software is furnished to
% do so, all subject to the following:
%
% The copyright notices in the Software and this entire statement, including
% the above license grant, this restriction and the following disclaimer,
% must be included in all copies of the Software, in whole or in part, and
% all derivative works of the Software, unless such copies or derivative
% works are solely in the form of machine-executable object code generated by
% a source language processor.
%
% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
% FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT
% SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
% FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE,
% ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
% DEALINGS IN THE SOFTWARE.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ProvidesPackage{extouchtriangle}
%%fakesection Argument processing
% Default Arguments
% We include "Evan" in all of these to make sure
% that they don't collide with anything in external packages
\newif\ifextouchtrianglefancy\extouchtrianglefancytrue
\newif\ifextouchtriangleotis\extouchtriangleotisfalse
\newif\ifextouchtrianglehdr\extouchtrianglehdrtrue
\newif\ifextouchtrianglehref\extouchtrianglehreftrue
\newif\ifextouchtrianglesetup\extouchtrianglesetuptrue
\newif\ifextouchtrianglethm\extouchtrianglethmtrue
\newif\ifextouchtrianglesecthm\extouchtrianglesecthmfalse
\newif\ifextouchtriangleht\extouchtrianglehtfalse
\newif\ifextouchtrianglepkg\extouchtrianglepkgtrue
\newif\ifextouchtrianglepdf\extouchtrianglepdftrue
\newif\ifextouchtriangleauthor\extouchtriangleauthortrue
\newif\ifextouchtrianglechinese\extouchtrianglechinesefalse
\newif\ifextouchtrianglemdthm\extouchtrianglemdthmfalse
\newif\ifextouchtrianglepatchasy\extouchtrianglepatchasyfalse
\newif\ifextouchtrianglehints\extouchtrianglehintsfalse
\newif\ifextouchtriangleasy\extouchtriangleasytrue
\newif\ifextouchtrianglecolorsec\extouchtrianglecolorsecfalse
\newif\ifextouchtriangletitlemark\extouchtriangletitlemarktrue
\newif\ifextouchtriangleepdenabled\extouchtriangleepdenabledtrue
\newif\ifextouchtrianglebritish\extouchtrianglebritishtrue
\newif\ifextouchtrianglebib\extouchtrianglebibfalse
\newif\ifextouchtrianglepoiret\extouchtrianglepoiretfalse
\newif\ifextouchtriangleiwona\extouchtriangleiwonafalse
\newif\ifextouchtrianglewater\extouchtrianglewaterfalse
\newif\ifextouchtriangleemoji\extouchtriangleemojitrue
\newif\ifextouchtrianglectp\extouchtrianglectptrue
%Receive Arguments
\DeclareOption{chinese}{\extouchtrianglechinesetrue} % Chinese support
% allow href to override this one
\DeclareOption{water}{\extouchtrianglewatertrue}
\DeclareOption{iwona}{\extouchtriangleiwonatrue}
\DeclareOption{poiret}{\extouchtrianglepoirettrue}
\DeclareOption{extouchtriangle}{\extouchtrianglesecthmtrue\extouchtrianglemdthmtrue\extouchtrianglecolorsectrue}
\DeclareOption{sexy}{\extouchtrianglesecthmtrue\extouchtrianglemdthmtrue\extouchtrianglecolorsectrue}
\DeclareOption{noctp}{\extouchtrianglectpfalse}
% long docs
\DeclareOption{geo}{\extouchtrianglesecthmtrue
\extouchtrianglemdthmtrue \extouchtrianglecolorsectrue}
\DeclareOption{classic}{\extouchtrianglesecthmtrue
\extouchtrianglemdthmtrue \extouchtrianglecolorsectrue}
\DeclareOption{intouchtriangle}{\extouchtrianglefancytrue}
\DeclareOption{nointouchtriangle}{\extouchtrianglefancyfalse}
\DeclareOption{hdr}{\extouchtrianglehdrtrue}
\DeclareOption{nohdr}{\extouchtrianglehdrfalse}
\DeclareOption{href}{\extouchtrianglehreftrue}
\DeclareOption{nohref}{\extouchtrianglehreffalse}
\DeclareOption{otis}{\extouchtriangleotistrue}
\DeclareOption{noemoji}{\extouchtriangleemojifalse}
\DeclareOption{nosetup}{\extouchtrianglesetupfalse}
\DeclareOption{thm}{\extouchtrianglethmtrue}
\DeclareOption{nothm}{\extouchtrianglethmfalse}
\DeclareOption{secthm}{\extouchtrianglesecthmtrue}
\DeclareOption{nosecthm}{\extouchtrianglesecthmfalse}
\DeclareOption{ht}{\extouchtrianglehttrue}
\DeclareOption{nopdf}{\extouchtrianglepdffalse}
\DeclareOption{nopkg}{\extouchtrianglepkgfalse}
\DeclareOption{noauthor}{\extouchtriangleauthorfalse}
\DeclareOption{titlemark}{\extouchtriangletitlemarktrue} % Sets title
% in ohead, not \rightmark
\DeclareOption{sectionmark}{\extouchtriangletitlemarkfalse} % Uses
% \rightmark not title in ohead

\DeclareOption{mdthm}{\extouchtrianglemdthmtrue}
\DeclareOption{nomdthm}{\extouchtrianglemdthmfalse}
\DeclareOption{colorsec}{\extouchtrianglecolorsectrue}
\DeclareOption{nocolorsec}{\extouchtrianglecolorsecfalse}

\DeclareOption{patchasy}{\extouchtrianglepatchasytrue}
\DeclareOption{noasy}{\extouchtriangleasyfalse}
\DeclareOption{epd}{\extouchtriangleepdenabledtrue}

\DeclareOption{british}{\extouchtrianglebritishtrue}
\DeclareOption{american}{\extouchtrianglebritishfalse}

\DeclareOption{bib}{\extouchtrianglebibtrue}

% legacy diagrams option, for backwards compatibility
\DeclareOption{diagrams}{}
\DeclareOption{nodiagrams}{}

\ProcessOptions\relax

% if packages not loaded, turn off mdthm and asy
\ifextouchtrianglepkg\else\extouchtrianglemdthmfalse\fi
\ifextouchtrianglepkg\else\extouchtriangleasyfalse\fi

% If no setup, turn off theorems
\ifextouchtrianglesetup\else\extouchtrianglethmfalse\fi

%%fakesection Some macros

%% set inconsolata as default monospaced font
\newcommand{\slug}[1]{\date{\texttt{#1}}}
%Small commands
\ifextouchtrianglewater
\usepackage{draftwatermark}
\SetWatermarkAngle{32}
\SetWatermarkLightness{0.98}
\SetWatermarkScale{1.5}
\SetWatermarkFontSize{32pt}
\SetWatermarkText{By extouchtriangle}
\fi
\ifextouchtriangleotis
\usepackage{draftwatermark}
\SetWatermarkAngle{32}
\SetWatermarkLightness{0.99}
\SetWatermarkFontSize{32pt}
\SetWatermarkScale{2.5}

\fi
\ifextouchtrianglepoiret
\usepackage{PoiretOne}
\usepackage[T1]{fontenc}
\fi
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\usepackage{gensymb}
\DeclareFontFamily{OMX}{yhex}{}
\DeclareFontShape{OMX}{yhex}{m}{n}{<->yhcmex10}{}
\DeclareSymbolFont{yhlargesymbols}{OMX}{yhex}{m}{n}
\DeclareMathAccent{\wideparen}{\mathord}{yhlargesymbols}{"F3}
\ifextouchtrianglepkg
\usepackage[minimal]{yhmath}
\usepackage{derivative}
\fi
\newcommand{\fl}[1]{\left \lfloor #1 \rfloor \right}
\makeatletter
\ifextouchtriangleiwona
\usepackage[T1]{fontenc}
\usepackage[light,math]{iwona}
\fi
\reversemarginpar
\newcommand{\arc}[1]{\wideparen{#1}}
\newcommand{\ang}{\angle}
\newcommand{\co}{\cos}
\newcommand{\si}{\sin}
\newcommand*\arch{\vcenter{\hbox{\includegraphics[height=0.9em]{tokyotower.png}}}}
\newcommand*\orthic{\includegraphics{Week7-2.pdf}}
\newcommand{\awd}{and we're done.}
\newcommand{\tcop}{This completes our proof.}
\newcommand{\tfop}{This finishes our proof.}
\newcommand{\prtaimewiki}[3]{\marginpar{\ifthenelse{#1>82}{\href{https://artofproblemsolving.com/wiki/index.php/19#1_AIME_#2_Problems/Problem_#3}{\sffamily
        \footnotesize
    \color{red!}#1A#2P#3}}{\href{https://artofproblemsolving.com/wiki/index.php/20#1_AIME_#2_Problems/Problem_#3}{\sffamily
\footnotesize \color{red!}#1A#2P#3}}}}
\newcommand{\printpuid}[1]{\marginpar{\href{https://otis.evanchen.cc/arch/#1}{\footnotesize
\color{blue!}$\arch$ \texttt{#1}}}}
\newcommand{\marginpuid}[1]{\marginpar{\href{https://otis.evanchen.cc/arch/#1}{\footnotesize
\color{blue!}$\arch$ \texttt{#1}}}}
\newcommand{\textpuid}[1]{\href{https://otis.evanchen.cc/arch/#1}{#1}}
\newcommand{\cbrt}[1]{\sqrt[3]{#1}}
\newcommand{\rt}[2]{\sqrt[#1]{#2}}
\newcommand{\degr}{\degree}
\newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\sym}{\operatorname{sym}}
\newcommand{\ceiling}[1]{\left\lceil #1 \right\rceil}
\newcommand{\mailto}[1]{\href{mailto:#1}{\texttt{#1}}}
\newcommand{\ol}{\overline}
\newcommand{\ul}{\underline}
\newcommand{\wt}{\widetilde}
\newcommand{\wh}{\widehat}
\newcommand{\eps}{\varepsilon}
\newcommand{\vocab}[1]{\textbf{\color{blue}\sffamily #1}}
\providecommand{\alert}{\vocab}
\providecommand{\half}{\frac{1}{2}}
\ifextouchtriangleemoji
\usepackage{emoji}
\setemojifont{Noto Color Emoji}
\fi
\newcommand{\catname}{\mathsf}
\newcommand{\hrulebar}{
  \par\hspace{\fill}\rule{0.95\linewidth}{.7pt}\hspace{\fill}
  \par\nointerlineskip \vspace{\baselineskip}
}
\providecommand{\arc}[1]{\wideparen{#1}}

%For use in author command
\newcommand{\plusemail}[1]{\\ \normalfont \texttt{\mailto{#1}}}

%More commands and math operators
%
\usepackage[dvipsnames]{xcolor}
\definecolor{CtpRed}{HTML}{f38ba8}
\definecolor{CtpSapphire}{HTML}{74c7ec}
\DeclareMathOperator{\cis}{cis}
\DeclareMathOperator*{\lcm}{lcm}
\DeclareMathOperator*{\argmin}{arg min}
\DeclareMathOperator*{\argmax}{arg max}
\newcommand{\code}[1]{\texttt{#1}}
%Convenient Environments
\newenvironment{soln}{
\begin{proof}[Solution]}{
\end{proof}}
\newenvironment{parlist}{
\begin{inparaenum}[(i)]}{
\end{inparaenum}}
\newenvironment{gobble}{\setbox\z@\vbox\bgroup}{\egroup}
\newenvironment{dummy}{}{}
%Inequalities
\newcommand{\cycsum}{\sum_{\mathrm{cyc}}}
\newcommand{\symsum}{\sum_{\mathrm{sym}}}
\newcommand{\cycprod}{\prod_{\mathrm{cyc}}}
\newcommand{\symprod}{\prod_{\mathrm{sym}}}

%From H113 "Introduction to Abstract Algebra" at UC Berkeley
\newcommand{\CC}{\mathbb C}
\newcommand{\FF}{\mathbb F}
\newcommand{\NN}{\mathbb N}
\newcommand{\QQ}{\mathbb Q}
\newcommand{\RR}{\mathbb R}
\newcommand{\ZZ}{\mathbb Z}
\newcommand{\EE}{\mathbb E}
\newcommand{\charin}{\text{ char }}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Inn}{Inn}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\GL}{GL} % General linear group
\DeclareMathOperator{\SL}{SL} % Special linear group
\DeclareMathOperator{\Vol}{Vol} % Special linear group

%From Kiran Kedlaya's "Geometry Unbound"
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert}
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\dang}{\measuredangle} %% Directed angle
\newcommand{\ray}[1]{\overrightarrow{#1}}
\newcommand{\seg}[1]{\overline{#1}}

%From M275 "Topology" at SJSU
\DeclareMathOperator{\id}{id}
\newcommand{\taking}[1]{\xrightarrow{#1}}
\newcommand{\inv}{^{-1}}

%From M170 "Introduction to Graph Theory" at SJSU
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\ord}{ord}
\newcommand{\defeq}{\overset{\mathrm{def}}{=}}

%From the USAMO .tex files
\newcommand{\ts}{\textsuperscript}
\newcommand{\dg}{^\circ}
\newcommand{
\ii}{
\item}

% From Math 55 and Math 145 at Harvard
\newenvironment{subproof}[1][Proof]{%
\begin{proof}[#1] \renewcommand{\qedsymbol}{$\blacksquare$}}%
  {
\end{proof}}

\newcommand{\liff}{\leftrightarrow}
\newcommand{\lthen}{\rightarrow}
\newcommand{\opname}{\operatorname}
\newcommand{\surjto}{\twoheadrightarrow}
\newcommand{\injto}{\hookrightarrow}
\newcommand{\On}{\mathrm{On}} % ordinals
\DeclareMathOperator{\img}{im} % Image
\DeclareMathOperator{\Img}{Im} % Image
\DeclareMathOperator{\coker}{coker} % Cokernel
\DeclareMathOperator{\Coker}{Coker} % Cokernel
\DeclareMathOperator{\Ker}{Ker} % Kernel
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\Spec}{Spec} % spectrum
\DeclareMathOperator{\Tr}{Tr} % trace
\DeclareMathOperator{\pr}{pr} % projection
\DeclareMathOperator{\ext}{ext} % extension
\DeclareMathOperator{\pred}{pred} % predecessor
\DeclareMathOperator{\dom}{dom} % domain
\DeclareMathOperator{\ran}{ran} % range
\DeclareMathOperator{\Hom}{Hom} % homomorphism
\DeclareMathOperator{\More}{More} % morphisms
\DeclareMathOperator{\End}{End} % endomorphism

% Things Lie
\newcommand{\kb}{\mathfrak b}
\newcommand{\kg}{\mathfrak g}
\newcommand{\kh}{\mathfrak h}
\newcommand{\kn}{\mathfrak n}
\newcommand{\ku}{\mathfrak u}
\newcommand{\kz}{\mathfrak z}
\DeclareMathOperator{\Ext}{Ext} % Ext functor
\DeclareMathOperator{\Tor}{Tor} % Tor functor
\newcommand{\gl}{\opname{\mathfrak{gl}}} % frak gl group
\def\sl{\opname{\mathfrak{sl}}} % frak sl group chktex 6

% More script letters etc.
\newcommand{\SA}{\mathcal A}
\newcommand{\SB}{\mathcal B}
\newcommand{\SC}{\mathcal C}
\newcommand{\SF}{\mathcal F}
\newcommand{\SG}{\mathcal G}
\newcommand{\SH}{\mathcal H}
\newcommand{\SP}{\mathcal P}
\newcommand{\OO}{\mathcal O}

\newcommand{\SCA}{\mathscr A}
\newcommand{\SCB}{\mathscr B}
\newcommand{\SCC}{\mathscr C}
\newcommand{\SCD}{\mathscr D}
\newcommand{\SCE}{\mathscr E}
\newcommand{\SCF}{\mathscr F}
\newcommand{\SCG}{\mathscr G}
\newcommand{\SCH}{\mathscr H}

% Mathfrak primes
\newcommand{\km}{\mathfrak m}
\newcommand{\kp}{\mathfrak p}
\newcommand{\kq}{\mathfrak q}

%%fakesection Asymptote setup
\ifextouchtriangleasy
\ifextouchtrianglepatchasy
\usepackage{patchasy}
\else
\usepackage{asymptote}
\fi
\begin{asydef}
  import catppuccin;
  defaultpen(fontsize(10pt)+text);
  size(10cm); // set a reasonable default
  usepackage("amsmath");
  usepackage("amssymb");
  settings.tex="pdflatex";
  settings.outformat="pdf";
  // Replacement for olympiad+cse5 which is not standard
  import olympiad;
  import cse5;
  // recalibrate fill and filldraw for conics
  // some geometry
  // cse5 abbreviations
  // cse5 more useful functions
  picture CC() {
    picture p=rotate(0)*currentpicture;
    currentpicture.erase();
    return p;
  }
\end{asydef}

%%fakesection BEGIN MAIN SETUP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ifextouchtrianglesetup
%%fakesection Set up author and date
\ifextouchtriangleauthor
\title{} % empty title to avoid crashes
\ifluatex
\author{extouchtriangle}
\else
\author{\color{blue!}extouchtriangle}
\fi
\date{\today}
\fi
%%fakesection Hyperref
\ifextouchtrianglepkg
\PassOptionsToPackage{svgnames,dvipsnames,x11names,table}{xcolor}
\usepackage[dvipsnames]{xcolor}
\ifextouchtrianglebib
\usepackage[backend=biber,backref=true,style=alphabetic]{biblatex}
\DeclareFieldFormat{labelalpha}{\textbf{\small #1}} % citation ID's
% in small-bold
\DefineBibliographyStrings{english}{%
  backrefpage  = {cited p.}, % for single page number
  backrefpages = {cited pp.} % for multiple page numbers
}
\DeclareFieldFormat{journaltitle}{\mkbibemph{#1},} % italic journal
% title with comma
\DeclareFieldFormat[inbook,thesis]{title}{\mkbibemph{#1}\addperiod} %
% italic title with period
\DeclareFieldFormat[article]{title}{#1} % title of journal article is
% printed as normal text
\DeclareFieldFormat[article]{volume}{\textbf{#1}\addcolon\space} %
% bold volume numbers
% Separate ISBN-13 field
\DeclareSourcemap{\maps[datatype=bibtex]{\map{\step[fieldsource=ISBN-13,fieldtarget=ISBN]}}}
% extouchtriangle likes small caps for bibliography author names
\renewcommand{\mkbibnamegiven}[1]{\textsc{#1}}
\renewcommand{\mkbibnamefamily}[1]{\textsc{#1}}
\renewcommand{\mkbibnameprefix}[1]{\textsc{#1}}
\renewcommand{\mkbibnamesuffix}[1]{\textsc{#1}}
% Drop trailing punctuation in bibliography names
\renewcommand{\finentrypunct}{}
\fi
\ifextouchtrianglehref
\usepackage[colorlinks=true,pdfusetitle]{hyperref}
\hypersetup{pdfkeywords={extouchtriangle.sty},pdfsubject={web.evanchen.cc}}
\definecolor{RoyalBlue}{rgb}{0.25, 0.41, 0.88}
\definecolor{VibrantPurple}{rgb}{0.552, 0.0117, 1}
\hypersetup{urlcolor=VibrantPurple,linkcolor=RoyalBlue,citecolor=ForestGreen}
\ifextouchtrianglectp
\usepackage[mocha]{catppuccinpalette}
\pagecolor{CtpBase}
\color{CtpText}
\hypersetup{urlcolor=CtpPink,linkcolor=CtpSky,citecolor=CtpGreen}

\fi
\fi
\usepackage[nameinlink]{cleveref}
\fi

%%fakesection New theorem styles
\ifextouchtrianglethm
\usepackage{amsthm}
\usepackage{thmtools}
\fi
\ifextouchtrianglemdthm
\ifextouchtrianglethm
%% theorem packages loaded already
\else
\usepackage{amsthm}
\usepackage{thmtools}
\fi
\usepackage[framemethod=TikZ]{mdframed}
\usetikzlibrary{shadows}
% https://tex.stackexchange.com/a/292090/76888
% https://github.com/marcodaniel/mdframed/issues/12
\xpatchcmd{\endmdframed}
{\aftergroup\endmdf@trivlist\color@endgroup}
{\endmdf@trivlist\color@endgroup\@doendpe}
{}{}

\mdfdefinestyle{mdbluebox}{%
  roundcorner=10pt,
  linewidth=1pt,
  skipabove=12pt,
  innerbottommargin=9pt,
  skipbelow=2pt,
  linecolor=blue,
  nobreak=true,
  backgroundcolor=TealBlue!5,
}
\declaretheoremstyle[
  headfont=\sffamily\bfseries\color{MidnightBlue},
  mdframed={style=mdbluebox},
  headpunct={\\[3pt]},
  postheadspace={0pt}
]{thmbluebox}
\declaretheoremstyle[
  headfont=\bfseries\color{RawSienna},
  mdframed={style=mdredbox},
  headpunct={\\[3pt]},
  postheadspace=0pt,
]{thmredbox}

\mdfdefinestyle{mdredbox}{%
  linewidth=0.5pt,
  skipabove=12pt,
  frametitleaboveskip=5pt,
  frametitlebelowskip=0pt,
  skipbelow=2pt,
  frametitlefont=\bfseries,
  innertopmargin=4pt,
  innerbottommargin=8pt,
  nobreak=true,
  backgroundcolor=Salmon!5,
  linecolor=RawSienna,
}
\declaretheoremstyle[
  headfont=\bfseries\color{RawSienna},
  mdframed={style=mdredbox},
  headpunct={\\[3pt]},
  postheadspace={0pt},
]{thmredbox}

\mdfdefinestyle{mdgreenbox}{%
  skipabove=8pt,
  skipbelow=0pt,
  linewidth=2pt,
  rightline=false,
  leftline=true,
  topline=false,
  bottomline=false,
  linecolor=CtpGreen,
  backgroundcolor=CtpGreen!10!CtpBase,
}
\declaretheoremstyle[
  headfont=\bfseries\sffamily\color{CtpGreen},
  bodyfont=\normalfont\color{CtpText},
  spaceabove=2pt,
  spacebelow=1pt,
  mdframed={style=mdgreenbox},
  headpunct={ --- },
]{thmgreenbox}

\mdfdefinestyle{mdblackbox}{%
  skipabove=8pt,
  linewidth=3pt,
  rightline=false,
  leftline=true,
  topline=false,
  bottomline=false,
  linecolor=black,
  backgroundcolor=RedViolet!5!gray!5,
}
\declaretheoremstyle[
  headfont=\bfseries,
  bodyfont=\normalfont\small,
  spaceabove=0pt,
  spacebelow=0pt,
  mdframed={style=mdblackbox}
]{thmblackbox}

\mdfdefinestyle{mdpurplebox}{%
  roundcorner=10pt,
  linewidth=1pt,
  skipabove=12pt,
  skipbelow=12pt,
  innertopmargin=9pt,
  innerbottommargin=9pt,
  linecolor=black,
  nobreak=true,
  backgroundcolor=Orchid!10,
  shadow=true,
  shadowsize=6pt,
  shadowcolor=black!30,
  frametitleaboveskip=8pt,
  frametitlebelowskip=8pt,
  frametitlebackgroundcolor=Violet!50!black,
  frametitlefont=\bfseries\sffamily\color{white},
  frametitlerule=true,
}
\newcommand{\listhack}{$\empty$\vspace{-2em}}
\fi

%%fakesection Theorem setup
\ifextouchtrianglethm
\theoremstyle{definition}
%Branching here: the option secthm changes theorems to be labelled by section
\ifextouchtrianglemdthm
\ifextouchtrianglesecthm
\declaretheorem[style=thmbluebox,name=Theorem,numberwithin=section]{theorem}
\else
\declaretheorem[style=thmbluebox,name=Theorem]{theorem}
\fi
\declaretheorem[style=thmbluebox,name=Lemma,sibling=theorem]{lemma}
\declaretheorem[style=thmbluebox,name=Proposition,sibling=theorem]{proposition}
\declaretheorem[style=thmbluebox,name=Corollary,sibling=theorem]{corollary}
\declaretheorem[style=thmbluebox,name=Assumption,sibling=theorem]{assume}
\declaretheorem[style=thmbluebox,name=Theorem,numbered=no]{theorem*}
\declaretheorem[style=thmbluebox,name=Lemma,numbered=no]{lemma*}
\declaretheorem[style=thmbluebox,name=Proposition,numbered=no]{proposition*}
\declaretheorem[style=thmbluebox,name=Corollary,numbered=no]{corollary*}
\declaretheorem[style=thmbluebox,name=Assumption,numbered=no]{assume*}
\else
\ifextouchtrianglesecthm
\declaretheorem[name=Theorem,numberwithin=section]{theorem}
\else
\declaretheorem[name=Theorem]{theorem}
\fi
\declaretheorem[name=Lemma,sibling=theorem]{lemma}
\declaretheorem[name=Proposition,sibling=theorem]{proposition}
\declaretheorem[name=Corollary,sibling=theorem]{corollary}
\declaretheorem[name=Assumption,sibling=theorem]{assume}
\declaretheorem[name=Theorem,numbered=no]{theorem*}
\declaretheorem[name=Lemma,numbered=no]{lemma*}
\declaretheorem[name=Proposition,numbered=no]{proposition*}
\declaretheorem[name=Corollary,numbered=no]{corollary*}
\declaretheorem[name=Assumption,numbered=no]{assume*}
\fi

\ifextouchtrianglemdthm
\declaretheorem[style=thmgreenbox,name=Algorithm,sibling=theorem]{algorithm}
\declaretheorem[style=thmgreenbox,name=Algorithm,numbered=no]{algorithm*}
\declaretheorem[style=thmgreenbox,name=Claim,sibling=theorem]{claim}
\declaretheorem[style=thmgreenbox,name=Claim,numbered=no]{claim*}
\else
\declaretheorem[name=Algorithm,sibling=theorem]{algorithm}
\declaretheorem[name=Algorithm,numbered=no]{algorithm*}
\declaretheorem[name=Claim,sibling=theorem]{claim}
\declaretheorem[name=Claim,numbered=no]{claim*}
\fi

\ifextouchtrianglemdthm
\declaretheorem[style=thmredbox,name=Example,sibling=theorem]{example}
\declaretheorem[style=thmredbox,name=Example,numbered=no]{example*}
\else
\declaretheorem[name=Example,sibling=theorem]{example}
\declaretheorem[name=Example,numbered=no]{example*}
\fi

% Remark-style theorems
\ifextouchtrianglemdthm
\declaretheorem[style=thmblackbox,name=Remark,sibling=theorem]{remark}
\declaretheorem[style=thmblackbox,name=Remark,numbered=no]{remark*}
\else
\declaretheorem[name=Remark,sibling=theorem]{remark}
\declaretheorem[name=Remark,numbered=no]{remark*}
\fi

\ifextouchtrianglemdthm
\declaretheoremstyle[
  headfont=\color{blue!40!black}\normalfont\bfseries,
  spaceabove=8pt,
  spacebelow=8pt,
  bodyfont=\normalfont
]{basehead}
\else
\declaretheoremstyle[spaceabove=6pt,spacebelow=6pt]{basehead}
\fi

\declaretheorem[style=basehead,name=Required Problem,numbered=no]{reqproblem*}
\declaretheorem[style=basehead,name=Answer,sibling=theorem]{answer}
\declaretheorem[style=basehead,name=Answer,numbered=no]{answer*}
\declaretheorem[style=basehead,name=Conjecture,sibling=theorem]{conjecture}
\declaretheorem[style=basehead,name=Case,sibling=theorem]{case}
\declaretheorem[style=basehead,name=Case,numbered=no]{case*}
\declaretheorem[style=basehead,name=Conjecture,numbered=no]{conjecture*}
\declaretheorem[style=basehead,name=Definition,sibling=theorem]{definition}
\declaretheorem[style=basehead,name=Definition,numbered=no]{definition*}
\declaretheorem[style=basehead,name=Exercise,sibling=theorem]{exercise}
\declaretheorem[style=basehead,name=Exercise,numbered=no]{exercise*}
\declaretheorem[style=basehead,name=Fact,sibling=theorem]{fact}
\declaretheorem[style=basehead,name=Fact,numbered=no]{fact*}
\declaretheorem[style=basehead,name=Problem,sibling=theorem]{problem}
\declaretheorem[style=basehead,name=Problem,numbered=no]{problem*}
\declaretheorem[style=basehead,name=Question,sibling=theorem]{quest}
\declaretheorem[style=basehead,name=Question,numbered=no]{quest*}

\ifextouchtrianglepkg
\Crefname{answer}{Answer}{Answers}
\Crefname{assume}{Assumption}{Assumptions}
\Crefname{claim}{Claim}{Claims}
\Crefname{conjecture}{Conjecture}{Conjectures}
\Crefname{exercise}{Exercise}{Exercises}
\Crefname{fact}{Fact}{Facts}
\Crefname{problem}{Problem}{Problems}
\Crefname{quest}{Question}{Questions}
\fi
\fi

%%fakesection Fancy section and chapter heads
\ifextouchtrianglecolorsec
\@ifundefined{KOMAClassName}{}{
  \@ifundefined{chapter}{}{
    \addtokomafont{partprefix}{\rmfamily}
    \renewcommand*{\partformat}{\color{purple}
    \scalebox{2.5}{\thepart}\enlargethispage{2em}}
    \addtokomafont{chapterprefix}{\raggedleft}
    \RedeclareSectionCommand[beforeskip=0.5em]{chapter}
    \renewcommand*{\chapterformat}{\mbox{%
        \scalebox{1.5}{\chapappifchapterprefix{\nobreakspace}}%
    \scalebox{2.718}{\color{blue}\thechapter}\enskip}}
  }
  \renewcommand*{\sectionformat}%
  {\color{CtpBlue}\S\thesection\enskip}
  \renewcommand*{\subsectionformat}%
  {\color{CtpBlue}\S\thesubsection\enskip}
  \renewcommand*{\subsubsectionformat}%
  {\color{CtpBlue}\S\thesubsubsection\enskip}
  \addtokomafont{paragraph}{\color{orange!35!black}\P\ }
  \KOMAoptions{numbers=noenddot}
  %\usetocstyle{KOMAlike}
}
\fi

%%fakesection Loads a bunch of useful packages (but allow disabling)
\ifextouchtrianglepkg
\ifextouchtriangleepdenabled
\IfFileExists{von.sty}{\usepackage[brave]{von}}{}
\fi
\usepackage{listings}
\usepackage{mathrsfs}
\usepackage{textcomp}
\lstset{basicstyle=\ttfamily\small,
  backgroundcolor=\color{yellow!3!white},
  breakatwhitespace=true,
  breaklines=true,
  commentstyle=\color{red!70!black},
  frame=shadowbox,
  frame=single,
  framerule=1pt,
  identifierstyle=\color{green!40!black},
  keywordstyle=\bfseries,
  keywordstyle=\bfseries\color{blue!80!black},
  numbers=left,
  numbersep=8pt,
  numberstyle=\scriptsize\sffamily\itshape\color{black!80},
  rulecolor=\color{blue!70!black},
  rulesepcolor=\color{blue!30!black},
  showstringspaces=false,
  stringstyle=\color{orange},
  tabsize=4,
  xleftmargin=15pt,
  xrightmargin=15pt,
  resetmargins=true,
} % chktex 6
\lstdefinelanguage{gitcommit}{
  alsoletter={:},
  morecomment=[l]{|},
  morekeywords={commit,Author:,Date:,chore,doc,edit,feat,fix,polish,style,tests,},
  sensitive=true,
}
\lstdefinelanguage{gitlog}{
  morekeywords={chore,doc,edit,feat,fix,polish,style,tests,},
  morecomment=[s]{[}{]}, % chktex 9
  sensitive=true,
}

\usepackage[shortlabels]{enumitem}
\usepackage[obeyFinal,textsize=scriptsize,shadow,loadshadowlibrary]{todonotes}
\usepackage{textcomp}
\usepackage{multirow}
\usepackage{ellipsis} % don't use ugly unicode ellipsis
\usepackage{epigraph}
\renewcommand{\epigraphsize}{\scriptsize}
\renewcommand{\epigraphwidth}{60ex}

% Tiny optimizations:
\usepackage{mathtools}
\usepackage{microtype}
\usepackage{xstring}
\usepackage{wrapfig}
\ifextouchtrianglebritish\usepackage[cleanlook,british]{isodate}\fi %
% day-first date
\usepackage{tikz-cd}
\usetikzlibrary{decorations.pathmorphing}
\allowdisplaybreaks

% a list I like for walkthrough's --- Drew-style parts
\newlist{walk}{enumerate}{3}
\setlist[walk]{label=\bfseries (\alph*)}
% list item for MO style rubrics
\newcommand{\worth}[1]{\def\hfill{\hskip 20pt plus 1fill}\dotfill%
  \IfEq{#1}{0}{\textbf{0~points}}%
  {\textbf{\color{blue}#1~point\IfEndWith{#1}{1}{}{s}}}%
\par}
\newcommand{\subworth}[1]{\def\hfill{\hskip 20pt plus 1fill}\dotfill%
  \IfEq{#1}{0}{{\footnotesize0~points}}%
  {\textbf{\footnotesize#1~point\IfEndWith{#1}{1}{}{s}}}%
\par}
\newlist{rubric}{enumerate}{2}
\setlist[rubric,1]{label=\Roman*.}
\setlist[rubric,2]{label=(\Roman{rubrici}.\alph*)}
\fi

%%fakesection \maketitle configuration
\@ifundefined{KOMAClassName}%
{} % do nothing outside KOMA class
{% If KOMA exists. . .
  \addtokomafont{subtitle}{\Large}
  \setkomafont{author}{\Large\scshape}
  \setkomafont{date}{\Large\normalsize}
}
\providecommand{\thetitle}{\@title}
\providecommand{\theauthor}{\@author}
\providecommand{\thedate}{\@date}

%%fakesection Page setup
\ifextouchtrianglefancy
\@ifundefined{KOMAClassName}
{
  \usepackage{fancyhdr}
  \setlength{\headheight}{0.75in}
  \setlength{\oddsidemargin}{0in}
  \setlength{\evensidemargin}{0in}
  \setlength{\voffset}{-1.0in}
  \setlength{\headsep}{10pt}
  \setlength{\textwidth}{6.5in}
  \setlength{\headwidth}{6.5in}
  \setlength{\textheight}{8.75in}
  \setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}
  \setlength{\footskip}{0.3in}
  \ifextouchtrianglehdr
  \renewcommand{\headrulewidth}{0.5pt}
  \renewcommand{\footrulewidth}{0.0pt}
  \pagestyle{fancy}
  \lhead{extouchtriangle}
  \chead{}
  \rhead{\nouppercase{\leftmark}}
  \lfoot{}
  \cfoot{\thepage}
  \rfoot{}
  \fi
}
{
  \usepackage[headsepline]{scrlayer-scrpage}
  \renewcommand{\headfont}{}
  \addtolength{\textheight}{3.14cm}
  \setlength{\footskip}{0.5in}
  \setlength{\headsep}{10pt}
  \ihead{\footnotesize\textbf{\theauthor} --- \thedate}
  \automark{section}
  \chead{}
  \ohead{\footnotesize\textbf{\thetitle}}
  \cfoot{\pagemark}
}
\fi
\setsansfont{Ubuntu}[
  BoldFont=Ubuntu Bold,
  ItalicFont=Ubuntu Italic,
  BoldItalicFont = Ubuntu Bold Italic,
]

%%fakesection Unicode

%%fakesection Hints
\ifextouchtrianglehints
\usepackage{answers}
\Newassociation{hint}{hintitem}{hints}
\renewcommand{\solutionextension}{out}
\Opensolutionfile{hints}
\newcommand{\makehints}{\Closesolutionfile{hints}\input{hints.out}} % chktex 27
\fi
%%fakesection END MAIN SETUP
\fi
